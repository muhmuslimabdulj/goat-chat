// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package pages

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"github.com/mmuslimabdulj/goat-chat/internal/domain"
	"github.com/mmuslimabdulj/goat-chat/view/components"
	"github.com/mmuslimabdulj/goat-chat/view/layouts"
)

func getTitle(roomName string) string {
	if roomName != "" {
		return "ğŸ”’ " + roomName
	}
	return "GOAT Chat"
}

func Index(users []*domain.User, roomName string, roomCode string) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<!-- Chaos Mode Overlay --> <div x-show=\"chaosMode\" x-transition class=\"fixed inset-0 z-50 pointer-events-none disco-overlay\"></div><!-- Reaction Container --> <div id=\"reaction-container\" class=\"fixed inset-0 z-40 pointer-events-none overflow-hidden\"></div><!-- Room Code Data (for WebSocket) --> ")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			if roomCode != "" {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "<div id=\"room-data\" data-code=\"")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var3 string
				templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(roomCode)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `view/pages/index.templ`, Line: 26, Col: 40}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "\" data-name=\"")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var4 string
				templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(roomName)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `view/pages/index.templ`, Line: 26, Col: 63}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "\" class=\"hidden\"></div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, " <!-- Main Layout --> <div class=\"h-full flex flex-col lg:grid lg:grid-cols-[280px_1fr_280px]\"><!-- Left Sidebar - User List (Desktop) --><aside class=\"hidden lg:flex lg:flex-col border-r-4 border-black bg-white min-h-0 overflow-hidden\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = components.UserList(users).Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "</aside><!-- Main Chat Area --><main class=\"flex-1 flex flex-col min-h-0 theme-transition\" style=\"background-color: var(--bg-color, #E0E0E0);\"><!-- Header --><header class=\"border-b-4 border-black bg-neon-yellow p-3 pt-[calc(env(safe-area-inset-top)+0.75rem)] lg:p-4 flex items-center justify-between gap-3 sticky top-0 z-30 shadow-sm\"><div class=\"flex flex-col min-w-0 flex-1 mr-2\"><h1 class=\"font-extrabold text-lg lg:text-2xl truncate leading-tight flex items-center gap-2\"><span x-show=\"roomCode\" x-text=\"'ğŸ”’ ' + roomName\"></span> <span x-show=\"!roomCode\">ğŸ”¥ GOAT Chat</span><!-- Connection Status Dot (visible on mobile) --><span class=\"lg:hidden w-2.5 h-2.5 rounded-full border border-black shrink-0\" :class=\"connected ? 'bg-green-500' : 'bg-red-500 animate-pulse'\" :title=\"connected ? 'Terhubung' : 'Terputus'\"></span></h1><div class=\"flex items-center text-xs lg:text-sm font-medium mt-1\"><span class=\"opacity-70 truncate hidden sm:inline\">Kamu adalah:</span> <span class=\"font-bold px-1.5 py-0.5 rounded border border-black sm:border-2 sm:ml-1 text-xs truncate max-w-[150px] sm:max-w-none shadow-[1px_1px_0px_0px_#000]\" :style=\"'background-color: ' + myColor\" x-text=\"myPersona\"></span><!-- Host Badge --><div x-show=\"amIHost\" class=\"ml-2 flex items-center gap-1 font-black px-2 py-0.5 rounded border-2 border-black text-[10px] sm:text-xs bg-white text-black shadow-[2px_2px_0px_0px_#000] uppercase tracking-wider transform -rotate-2\" x-transition><span>ğŸ‘‘</span> <span>HOST</span></div></div></div><div class=\"flex items-center gap-2\"><!-- Room Code Display --><template x-if=\"roomCode\"><div class=\"hidden lg:flex items-center bg-white border-2 border-black rounded-lg px-2 py-1\"><span class=\"text-xs font-mono text-gray-600 mr-2\">Kode:</span> <code class=\"font-mono font-bold text-sm\" x-text=\"roomCode\"></code> <button @click=\"copyRoomCode()\" class=\"ml-2 px-2 py-0.5 bg-gray-100 hover:bg-gray-200 rounded text-sm\" x-text=\"codeCopied ? 'âœ…' : 'ğŸ“‹'\"></button> <button @click=\"copyRoomLink()\" class=\"ml-1 px-2 py-0.5 bg-gray-100 hover:bg-gray-200 rounded text-sm\" title=\"Copy Room Link\" x-text=\"linkCopied ? 'âœ…' : 'ğŸ”—'\"></button></div></template><a x-show=\"roomCode\" href=\"/\" @click=\"clearRoomSession()\" class=\"px-3 py-1 bg-red-500 text-white font-bold rounded-lg border-2 border-black hover:bg-red-600 text-sm\">Keluar</a><!-- Mobile User Count --><button @click=\"showUsers = !showUsers\" class=\"lg:hidden px-3 py-2 font-bold rounded-lg border-4 border-black shadow-brutal-sm bg-white\">ğŸ‘¥ <span x-text=\"userCount\"></span></button></div></header><!-- Mobile User List Drawer --><div x-show=\"showUsers\" x-transition @click.away=\"showUsers = false\" class=\"lg:hidden absolute right-0 top-[calc(5rem+env(safe-area-inset-top))] w-72 max-h-96 z-30 border-4 border-black rounded-lg shadow-brutal bg-white flex flex-col overflow-hidden\"><div class=\"p-3 border-b-4 border-black bg-neon-yellow flex flex-col gap-2 shrink-0\"><!-- Mobile Room Code --><div class=\"flex items-center justify-between bg-white border-2 border-black rounded-lg px-2 py-1\"><span class=\"text-xs font-mono text-gray-600\">Kode:</span> <code class=\"font-mono font-bold text-sm\" x-text=\"roomCode\"></code><div class=\"flex gap-1\"><button @click=\"copyRoomCode()\" class=\"px-2 py-0.5 bg-gray-100 hover:bg-gray-200 rounded text-sm\" x-text=\"codeCopied ? 'âœ…' : 'ğŸ“‹'\" title=\"Copy Kode\"></button> <button @click=\"copyRoomLink()\" class=\"px-2 py-0.5 bg-gray-100 hover:bg-gray-200 rounded text-sm\" x-text=\"linkCopied ? 'âœ…' : 'ğŸ”—'\" title=\"Copy Link\"></button> <button @click=\"shareRoom()\" class=\"px-2 py-0.5 bg-gray-100 hover:bg-gray-200 rounded text-sm\" title=\"Share Room\">ğŸ“¤</button></div></div><!-- Online Count --><div class=\"flex items-center justify-between\"><span class=\"font-black text-sm uppercase\">ğŸ‘¥ Online: <span class=\"bg-black text-white px-2 py-0.5 text-xs font-bold\" x-text=\"userCount\"></span></span></div><!-- Battery Button Mobile --><button @click=\"requestBattery\" x-show=\"myBattery < 0\" class=\"w-full px-2 py-1 text-xs font-bold rounded border-2 border-black bg-white hover:bg-gray-100 text-center\">ğŸ”‹ Bagikan Baterai</button></div><div class=\"flex-1 overflow-y-auto\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = components.UserList(users).Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "</div></div><!-- Messages Area --><div id=\"messages\" class=\"flex-1 overflow-y-auto p-4 space-y-2\" x-ref=\"messagesContainer\"><!-- Welcome Message --><div class=\"flex justify-center my-4\"><div class=\"px-4 py-2 bg-gray-200 rounded-full text-xs font-medium text-gray-600 border-2 border-black\">ğŸ‰ Selamat datang di GOAT Chat! Ketik /help untuk melihat commands.</div></div><!-- Messages --><template x-for=\"(msg, index) in messages\" :key=\"msg.id || index\"><div><!-- Unread Messages Divider --><div x-show=\"unreadDividerIndex === index\" class=\"flex items-center gap-3 my-4 px-2\"><div class=\"flex-1 h-1 bg-neon-pink rounded-full\"></div><span class=\"px-4 py-1.5 bg-neon-pink text-white text-xs font-bold rounded-full border-2 border-black shadow-brutal-sm whitespace-nowrap\">Pesan Baru â¬‡ï¸</span><div class=\"flex-1 h-1 bg-neon-pink rounded-full\"></div></div><!-- System Messages (user join/leave/system) --><div x-show=\"msg.type === 'user_join' || msg.type === 'user_leave' || msg.type === 'system'\" class=\"flex justify-center my-4\"><div class=\"px-4 py-2 bg-gray-200 rounded-full text-xs font-medium text-gray-600 border-2 border-black\"><span x-text=\"msg.type === 'user_join' ? 'ğŸ‘‹ ' + msg.from_name + ' bergabung!' : (msg.type === 'user_leave' ? 'ğŸ‘» ' + msg.from_name + ' pergi...' : msg.from_name)\"></span></div></div><!-- Repo Info Messages --><div x-show=\"msg.type === 'repo_info'\" class=\"flex justify-center my-4\"><div class=\"w-full max-w-md bg-white rounded-xl border-4 border-black shadow-brutal p-6 text-center\"><div class=\"text-4xl mb-2\">ğŸ‘¨\u200dğŸ’»</div><div class=\"text-xl font-bold mb-2\">GOAT CHAT DEV</div><p class=\"text-xs text-gray-600 mb-4 px-4\" x-text=\"msg.payload?.desc\"></p><a :href=\"msg.payload?.url\" target=\"_blank\" class=\"inline-block w-full bg-black text-white font-bold py-3 rounded-lg border-2 border-transparent hover:bg-gray-800 hover:border-black transition-colors\">â­ Buka GitHub Repository</a></div></div><!-- Help Messages --><div x-show=\"msg.type === 'help'\" class=\"flex justify-center my-4\"><div class=\"w-full max-w-md bg-white rounded-xl border-4 border-black shadow-brutal p-4\"><div class=\"text-lg font-bold mb-3 text-center\">ğŸ“š DAFTAR PERINTAH</div><div class=\"space-y-2\"><template x-for=\"cmd in msg.payload?.commands\" :key=\"cmd.cmd\"><div class=\"flex items-start gap-2 text-sm border-b border-gray-100 pb-2\"><code class=\"bg-gray-200 px-2 py-1 rounded font-mono text-xs shrink-0\" x-text=\"cmd.cmd\"></code> <span class=\"text-gray-600 flex-1\" x-text=\"cmd.desc\"></span><code class=\"bg-green-100 text-green-700 px-1 rounded text-xs\" x-text=\"cmd.ex\"></code></div></template></div></div></div><!-- Chat Messages --><div x-show=\"msg.type === 'chat'\" :class=\"{'flex gap-3 mb-4': true, 'flex-row-reverse': isMyMessage(msg)}\"><div class=\"w-10 h-10 rounded-full border-4 border-black flex items-center justify-center text-lg font-bold shadow-brutal-sm shrink-0\" :style=\"'background-color: ' + (msg.from_color || '#FFD100')\" x-text=\"msg.from_name ? msg.from_name.charAt(0) : '?'\"></div><div class=\"min-w-0 overflow-hidden\" :class=\"{'max-w-[75%] lg:max-w-[60%]': true, 'text-right': isMyMessage(msg)}\"><div class=\"text-xs font-semibold mb-1 px-1\" :style=\"'color: ' + (msg.from_color || '#FFD100')\"><span x-text=\"msg.from_name\"></span> <span x-show=\"isHost(msg.from_id)\" title=\"Host\" class=\"ml-1\">ğŸ‘‘</span></div><div class=\"border-4 border-black rounded-lg p-3 shadow-brutal-sm bg-white text-left\" :class=\"{'caps-warning': msg.payload?.isCaps}\"><p class=\"text-sm leading-relaxed break-all\" x-html=\"formatMessage(msg.payload?.text || '')\"></p><span x-show=\"msg.payload?.isCaps\" class=\"text-xs text-red-500 font-bold\">ğŸ“¢ JANGAN TERIAK!</span></div><div class=\"text-[10px] text-gray-400 mt-1 px-1\" x-text=\"formatTime(msg.created_at)\"></div></div></div><!-- Dice Messages --><div x-show=\"msg.type === 'dice'\" class=\"flex justify-center my-4\"><div class=\"px-6 py-4 bg-neon-yellow rounded-xl border-4 border-black shadow-brutal text-center\"><div class=\"text-xs font-bold mb-2\" x-text=\"msg.from_name + ' melempar dadu' + ((msg.payload?.max && msg.payload.max !== 6) ? ' d' + msg.payload.max : '')\"></div><div class=\"text-4xl font-black\" :class=\"{ 'dice-result': msg.should_animate }\" x-text=\"'ğŸ² ' + (msg.payload?.result || 0)\"></div></div></div><!-- Flip Messages --><div x-show=\"msg.type === 'flip'\" class=\"flex justify-center my-4\"><div class=\"px-6 py-4 bg-neon-cyan rounded-xl border-4 border-black shadow-brutal text-center\"><div class=\"text-xs font-bold mb-2\" x-text=\"msg.from_name + ' membalik teks:'\"></div><div class=\"text-sm line-through opacity-50 mb-1\" x-text=\"msg.payload?.original\"></div><div class=\"text-xl font-bold\" x-text=\"msg.payload?.flipped\"></div></div></div><!-- Spin Messages --><div x-show=\"msg.type === 'spin'\" class=\"flex justify-center my-4\"><div class=\"px-6 py-4 bg-neon-pink rounded-xl border-4 border-black shadow-brutal text-center\"><div class=\"text-xs font-bold mb-2\" x-text=\"msg.from_name + ' mengirim pesan berputar:'\"></div><div class=\"text-xl font-bold spin-text\" x-text=\"msg.payload?.text\"></div></div></div><!-- TTS Messages --><div x-show=\"msg.type === 'tts'\" class=\"flex justify-center my-4\"><div @click=\"playTTSMessage(msg)\" class=\"px-6 py-4 bg-gradient-to-r from-blue-400 to-purple-500 rounded-xl border-4 border-black shadow-brutal text-center text-white cursor-pointer hover:scale-105 transition-transform active:scale-95 group relative\"><div class=\"text-xs font-bold mb-2 opacity-90\" x-text=\"msg.from_name + ' berbicara:'\"></div><div class=\"text-xl font-bold flex items-center justify-center gap-3\"><span class=\"text-2xl animate-pulse\">ğŸ”Š</span> <span x-text=\"msg.payload?.text\"></span></div><div class=\"text-[10px] mt-2 font-mono opacity-0 group-hover:opacity-100 transition-opacity bg-black/20 rounded px-2 py-0.5 inline-block\">Klik untuk putar ulang â†º</div></div></div><!-- Whisper Messages --><div x-show=\"msg.type === 'whisper'\" :class=\"{'flex gap-3 mb-4': true, 'flex-row-reverse': isMyMessage(msg)}\"><div class=\"w-10 h-10 rounded-full border-4 border-purple-800 flex items-center justify-center text-lg font-bold shadow-brutal-sm shrink-0 bg-purple-300\" x-text=\"msg.from_name ? msg.from_name.charAt(0) : '?'\"></div><div class=\"min-w-0 overflow-hidden\" :class=\"{'max-w-[75%] lg:max-w-[60%]': true, 'text-right': isMyMessage(msg)}\"><!-- Name + Whisper Badge --><div class=\"text-xs font-semibold mb-1 px-1 flex items-center gap-2 flex-wrap\" :class=\"isMyMessage(msg) ? 'justify-end' : ''\"><span class=\"bg-purple-900 text-white text-[10px] px-2 py-0.5 rounded font-bold border border-black\">ğŸ¤« BISIKAN</span> <span class=\"text-gray-700\" x-text=\"msg.from_name + ' â†’ ' + (msg.payload?.to_name || 'kamu')\"></span></div><div class=\"border-4 border-purple-800 rounded-lg p-3 shadow-brutal-sm bg-purple-200 text-left\"><p class=\"text-sm leading-relaxed break-all text-black font-medium\" x-text=\"msg.payload?.text\"></p></div><div class=\"text-[10px] text-gray-400 mt-1 px-1\" x-text=\"formatTime(msg.created_at)\"></div></div></div><!-- YouTube Messages --><div x-show=\"msg.type === 'youtube'\" class=\"flex justify-center my-4\"><div class=\"w-full max-w-md bg-white rounded-2xl border-4 border-black shadow-brutal overflow-hidden\"><!-- Header --><div style=\"background-color: #dc2626;\" class=\"text-white px-4 py-2 font-bold flex items-center gap-2\">â–¶ï¸ <span x-text=\"msg.from_name + ' membagikan video'\"></span></div><!-- Video container --><div class=\"aspect-video bg-black\"><iframe :src=\"'https://www.youtube.com/embed/' + msg.payload?.video_id\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen class=\"w-full h-full\"></iframe></div><!-- Footer --><div class=\"bg-gray-50 p-3 border-t-4 border-black flex items-center justify-between\"><a :href=\"msg.payload?.url\" target=\"_blank\" class=\"inline-flex items-center gap-2 px-4 py-2 bg-red-500 text-white text-sm font-bold rounded-lg border-2 border-black shadow-brutal-sm hover:bg-red-600 hover:translate-x-0.5 hover:translate-y-0.5 hover:shadow-none hover:scale-105 active:translate-x-1 active:translate-y-1 active:shadow-none active:scale-95 transition-all\">ğŸ”— Buka di YouTube</a> <span class=\"text-xs text-gray-400\" x-text=\"formatTime(msg.created_at)\"></span></div></div></div><!-- GIF Messages --><div x-show=\"msg.type === 'gif'\" :class=\"{'flex gap-3 mb-4': true, 'flex-row-reverse': isMyMessage(msg)}\"><div class=\"w-10 h-10 rounded-full border-4 border-black flex items-center justify-center text-lg font-bold shadow-brutal-sm shrink-0\" :style=\"'background-color: ' + (msg.from_color || '#FFD100')\" x-text=\"msg.from_name ? msg.from_name.charAt(0) : '?'\"></div><div :class=\"{'max-w-[300px]': true, 'text-right': isMyMessage(msg)}\"><div class=\"text-xs font-semibold mb-1 px-1\" :style=\"'color: ' + (msg.from_color || '#FFD100')\" x-text=\"msg.from_name\"></div><div class=\"gif-container border-4 border-black rounded-lg overflow-hidden shadow-brutal-sm\"><img :src=\"msg.payload?.url\" @load=\"handleImageLoad($el)\" alt=\"GIF\" class=\"w-full\" loading=\"lazy\"></div><div class=\"text-[10px] text-gray-400 mt-1 px-1\" x-text=\"formatTime(msg.created_at)\"></div></div></div><!-- Suit (Rock Paper Scissors) Messages --><div x-show=\"msg.type === 'suit'\" class=\"flex justify-center my-4\"><div class=\"px-6 py-4 bg-neon-purple rounded-xl border-4 border-black shadow-brutal text-center text-white\"><template x-if=\"msg.payload?.status === 'pending'\"><div><div class=\"text-lg font-bold mb-2\">âš”ï¸ TANTANGAN SUIT!</div><div class=\"text-sm\" x-text=\"msg.payload?.challenger_name + ' menantang ' + msg.payload?.opponent_name\"></div><!-- Timer --><div class=\"text-3xl font-black my-3\" x-text=\"Math.max(0, suitChallenges[msg.payload.id]?.timeLeft || 0) + 's'\"></div><!-- Actions --><div x-show=\"(isMe(msg.payload?.challenger_id, msg.payload?.challenger_name) || isMe(msg.payload?.opponent_id, msg.payload?.opponent_name)) && !hasMoved(msg.payload.id)\" class=\"mt-3 flex gap-2 justify-center\"><button @click=\"sendSuitMove('rock', msg.payload.id)\" class=\"w-12 h-12 flex items-center justify-center bg-white text-black rounded-lg border-3 border-black font-bold text-2xl hover:scale-110 transition-transform\">âœŠ</button> <button @click=\"sendSuitMove('paper', msg.payload.id)\" class=\"w-12 h-12 flex items-center justify-center bg-white text-black rounded-lg border-3 border-black font-bold text-2xl hover:scale-110 transition-transform\">âœ‹</button> <button @click=\"sendSuitMove('scissors', msg.payload.id)\" class=\"w-12 h-12 flex items-center justify-center bg-white text-black rounded-lg border-3 border-black font-bold text-2xl hover:scale-110 transition-transform\">âœŒï¸</button></div><div x-show=\"hasMoved(msg.payload.id)\" class=\"mt-2 text-sm italic font-medium bg-black/20 p-2 rounded-lg inline-block\">â³ Menunggu lawan memilih...</div></div></template><template x-if=\"msg.payload?.status === 'completed'\"><div><div class=\"text-lg font-bold mb-2\">ğŸ† HASIL SUIT!</div><div class=\"text-sm mb-2\" x-text=\"msg.payload?.challenger_name + ' vs ' + msg.payload?.opponent_name\"></div><div class=\"flex justify-center gap-6 my-4 bg-white/20 p-2 rounded-xl\"><div class=\"flex flex-col items-center\"><div class=\"text-3xl\" x-text=\"getSuitEmoji(msg.payload.moves[msg.payload.challenger_id])\"></div><div class=\"text-[10px] font-bold mt-1 max-w-[80px] truncate\" x-text=\"msg.payload.challenger_name\"></div></div><div class=\"flex items-center text-xl font-black italic\">VS</div><div class=\"flex flex-col items-center\"><div class=\"text-3xl\" x-text=\"getSuitEmoji(msg.payload.moves[msg.payload.opponent_id])\"></div><div class=\"text-[10px] font-bold mt-1 max-w-[80px] truncate\" x-text=\"msg.payload.opponent_name\"></div></div></div><div class=\"text-2xl font-bold\" x-text=\"msg.payload?.winner === 'draw' ? 'ğŸ¤ SERI!' : (isMe(msg.payload?.winner, msg.payload?.winner === msg.payload?.challenger_id ? msg.payload?.challenger_name : msg.payload?.opponent_name) ? 'ğŸ‰ KAMU MENANG!' : (msg.payload?.winner === msg.payload?.challenger_id ? msg.payload?.challenger_name : msg.payload?.opponent_name) + ' MENANG!')\"></div></div></template></div></div><!-- Truth or Dare Messages --><div x-show=\"msg.type === 'tod'\" class=\"flex justify-center my-4\"><div class=\"px-6 py-4 rounded-xl border-4 border-black shadow-brutal text-center\" :class=\"msg.payload?.type === 'truth' ? 'bg-blue-400' : 'bg-red-400'\"><div class=\"text-lg font-bold mb-2 text-white\" x-text=\"msg.payload?.type === 'truth' ? 'ğŸ¤ TRUTH' : 'ğŸ”¥ DARE'\"></div><div class=\"text-xs font-medium text-white opacity-80 mb-2\" x-text=\"'Untuk: ' + msg.from_name\"></div><div class=\"text-sm font-bold text-white\" x-text=\"msg.payload?.question\"></div></div></div><!-- Poll Messages --><div x-show=\"msg.type === 'poll'\" class=\"flex justify-center my-4\"><div class=\"px-6 py-4 bg-white rounded-xl border-4 border-black shadow-brutal w-full max-w-md\"><div class=\"text-lg font-bold mb-3\">ğŸ“Š <span x-text=\"msg.payload?.question\"></span></div><div class=\"space-y-2\"><template x-for=\"(opt, idx) in msg.payload?.options\" :key=\"idx\"><button @click=\"votePoll(msg.payload?.poll_id, idx)\" class=\"poll-option w-full text-left px-4 py-2 rounded-lg border-2 border-black bg-gray-100 hover:bg-neon-yellow\" :disabled=\"polls[msg.payload?.poll_id]?.voters?.includes(myId)\"><div class=\"flex justify-between items-center\"><span x-text=\"opt\"></span> <span class=\"text-xs font-bold\" x-text=\"(polls[msg.payload?.poll_id]?.votes?.[opt] || 0) + ' votes'\"></span></div><div class=\"poll-bar h-1 bg-neon-pink rounded mt-1\" :style=\"'width: ' + ((polls[msg.payload?.poll_id]?.votes?.[opt] || 0) * 20) + '%'\"></div></button></template></div><div class=\"text-xs text-gray-500 mt-2\" x-text=\"'Dibuat oleh ' + msg.from_name\"></div></div></div></div></template></div><!-- New Messages Indicator --><div x-show=\"hasNewMessages\" x-transition class=\"flex justify-center py-2\"><button @click=\"scrollToLatest()\" style=\"padding: 12px 32px;\" class=\"bg-neon-green text-black font-bold text-sm rounded-xl border-4 border-black shadow-[3px_3px_0px_0px_#000] hover:shadow-[1px_1px_0px_0px_#000] hover:translate-x-0.5 hover:translate-y-0.5 active:shadow-none active:translate-x-1 active:translate-y-1 transition-all flex items-center gap-2\">â¬‡ï¸ Pesan Baru</button></div><!-- Typing Indicator (floating above input) --><div x-show=\"typingText\" x-transition class=\"px-4 py-2\"><div class=\"inline-flex items-center gap-2 px-4 py-2 bg-gray-200 rounded-lg text-xs font-bold text-gray-700 border-2 border-black shadow-brutal-sm\"><span x-text=\"typingText\"></span> <span class=\"typing-pulse w-2 h-2 bg-gray-600 rounded-full\"></span> <span class=\"typing-pulse w-2 h-2 bg-gray-600 rounded-full\"></span> <span class=\"typing-pulse w-2 h-2 bg-gray-600 rounded-full\"></span></div></div><!-- Chat Input -->")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = components.ChatInput().Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "</main><!-- Right Sidebar - Info/Activity (Desktop) --><aside class=\"hidden lg:flex lg:flex-col border-l-4 border-black bg-white min-h-0 overflow-hidden\"><div class=\"p-4 border-b-4 border-black bg-neon-pink\"><h2 class=\"font-bold text-lg\">ğŸ“Š Status</h2></div><div class=\"flex-1 overflow-y-auto p-4 space-y-4\"><!-- Connection Status --><div class=\"border-4 border-black rounded-lg p-3 shadow-brutal-sm bg-white\"><div class=\"flex items-center gap-2\"><div class=\"w-3 h-3 rounded-full border-2 border-black\" :class=\"connected ? 'bg-neon-green' : 'bg-neon-red'\"></div><span class=\"text-sm font-medium\" x-text=\"connected ? 'Terhubung' : 'Terputus...'\"></span></div></div><!-- Battery Status (if shared) --><template x-if=\"myBattery >= 0\"><div class=\"border-4 border-black rounded-lg p-3 shadow-brutal-sm bg-white\"><div class=\"text-xs font-semibold mb-1\">ğŸ”‹ Baterai Kamu</div><div class=\"flex items-center gap-2\"><div class=\"flex-1 h-4 bg-gray-200 rounded-full border-2 border-black overflow-hidden\"><div class=\"h-full transition-all duration-300\" :class=\"myBattery >= 50 ? 'bg-neon-green' : (myBattery >= 20 ? 'bg-neon-yellow' : 'bg-neon-red')\" :style=\"'width: ' + myBattery + '%'\"></div></div><span class=\"text-sm font-bold\" x-text=\"myBattery + '%'\"></span></div></div></template><!-- Nobar Status --><template x-if=\"currentNobar\"><div class=\"border-4 border-black rounded-lg p-3 shadow-brutal-sm bg-gradient-to-r from-purple-100 to-pink-100\"><div class=\"text-xs font-semibold mb-2 flex items-center gap-1\"><span>ğŸ¬</span> Nobar <span class=\"ml-auto text-purple-600\" x-text=\"currentNobar?.is_playing ? 'â–¶ Playing' : 'â¸ Paused'\"></span></div><div class=\"text-sm font-bold truncate mb-2\" x-text=\"currentNobar?.title || 'Video'\"></div><div class=\"text-xs text-gray-600 mb-2\"><span x-text=\"formatMusicTime(nobarCurrentTime)\"></span> <span x-show=\"currentNobar?.duration > 0\" x-text=\"' / ' + formatMusicTime(currentNobar?.duration)\"></span></div><!-- Progress bar --><div class=\"w-full h-1.5 bg-gray-300 rounded-full mb-2 overflow-hidden\"><div class=\"h-full bg-purple-500 rounded-full\" :style=\"`width: ${nobarProgress}%`\"></div></div><!-- Actions --><div class=\"flex gap-2\"><!-- State 1: Not joined yet --><template x-if=\"!showNobarModal && !nobarMinimized && !nobarPlayer\"><button @click=\"joinNobar()\" class=\"flex-1 text-xs px-2 py-1 bg-purple-500 text-white font-bold rounded border-2 border-black hover:bg-purple-600\">ğŸ¿ Ikut Nobar</button></template><!-- State 2: Modal is open (watching) --><template x-if=\"showNobarModal\"><div class=\"flex-1 text-xs px-2 py-1 bg-green-100 text-green-700 font-bold rounded border-2 border-green-500 text-center\">ğŸ‘ Sedang Ditonton</div></template><!-- State 3: Minimized (playing in background) --><template x-if=\"nobarMinimized && !showNobarModal\"><button @click=\"joinNobar()\" class=\"flex-1 text-xs px-2 py-1 bg-yellow-100 text-yellow-700 font-bold rounded border-2 border-yellow-500 hover:bg-yellow-200\">ğŸ”Š Minimize â€¢ Buka</button></template><template x-if=\"nobarPlayer\"><button @click=\"closeNobar()\" class=\"w-8 h-8 flex items-center justify-center bg-red-500 text-white font-bold rounded border-2 border-black hover:bg-red-600\">âœ•</button></template></div></div></template><!-- Nobar Manager (Visible ONLY if items exist) --><template x-if=\"(nobarRequests && nobarRequests.length > 0) || (nobarQueue && nobarQueue.length > 0)\"><div class=\"mb-3 border-4 border-black rounded-lg p-3 shadow-brutal-sm bg-gradient-to-r from-blue-50 to-indigo-50\"><div class=\"text-xs font-bold mb-3 flex items-center gap-1 border-b-2 border-black pb-2\"><span>ğŸ‘®</span> NOBAR MANAGER</div><!-- Pending Requests --><template x-if=\"nobarRequests && nobarRequests.length > 0\"><div class=\"mb-4\"><div class=\"text-[10px] font-bold text-red-600 mb-2 flex items-center gap-1 animate-pulse\"><span>ğŸš¨</span> REQUEST MASUK</div><div class=\"space-y-2 max-h-40 overflow-y-auto pr-1\"><template x-for=\"req in nobarRequests\" :key=\"req.id\"><div class=\"bg-red-50 border-2 border-red-200 rounded-lg p-2 relative\"><div class=\"flex items-start justify-between gap-2\"><div class=\"flex-1 min-w-0\"><div class=\"font-bold text-xs truncate text-gray-800\" x-text=\"req.title\"></div><div class=\"text-[10px] text-gray-500\">dari <span x-text=\"req.requested_by_name\" class=\"font-bold\"></span></div></div><!-- Actions (Host Only) --><template x-if=\"amIHost\"><div class=\"flex gap-1 shrink-0\"><button @click=\"approveNobarRequest(req.id)\" class=\"w-7 h-7 flex items-center justify-center bg-green-500 text-white rounded border-2 border-black hover:bg-green-400 shadow-sm transition-transform active:scale-95\" title=\"Terima (Masuk Antrian)\">âœ“</button> <button @click=\"rejectNobarRequest(req.id)\" class=\"w-7 h-7 flex items-center justify-center bg-red-500 text-white rounded border-2 border-black hover:bg-red-400 shadow-sm transition-transform active:scale-95\" title=\"Tolak\">âœ•</button></div></template></div></div></template></div></div></template><!-- Playlist Queue --><template x-if=\"nobarQueue && nobarQueue.length > 0\"><div><div class=\"text-[10px] font-bold text-blue-600 mb-2 flex items-center gap-1\"><span>ğŸµ</span> DAFTAR PUTAR (PLAYLIST)</div><div class=\"space-y-2 max-h-48 overflow-y-auto pr-1\"><template x-for=\"(q, index) in nobarQueue\" :key=\"q.id\"><div class=\"bg-blue-50 border-2 border-blue-200 rounded-lg p-2\"><div class=\"flex items-center justify-between gap-2\"><div class=\"flex items-center gap-2 flex-1 min-w-0\"><div class=\"w-5 h-5 shrink-0 flex items-center justify-center bg-blue-200 text-blue-800 text-[10px] font-bold rounded-full border border-blue-300\" x-text=\"index + 1\"></div><div class=\"min-w-0\"><div class=\"font-bold text-xs truncate text-gray-800\" x-text=\"q.title\"></div><div class=\"text-[10px] text-gray-500\" x-text=\"q.requested_by_name\"></div></div></div><!-- Actions (Host Only) --><template x-if=\"amIHost\"><div class=\"flex gap-1 shrink-0\"><button @click=\"rejectNobarRequest(q.id)\" class=\"w-7 h-7 flex items-center justify-center bg-gray-200 text-gray-600 rounded border-2 border-gray-400 hover:bg-red-500 hover:text-white hover:border-black transition-colors\" title=\"Hapus dari Playlist\">ğŸ—‘</button></div></template></div></div></template></div></div></template></div></template><!-- Sync Music Player --><div x-show=\"(currentMusic && currentMusic.video_id) || musicQueue.length > 0 || pendingRequests.length > 0\" x-transition class=\"border-4 border-black rounded-xl shadow-brutal-sm bg-gradient-to-br from-white to-purple-50 overflow-hidden\"><div class=\"p-3\"><!-- Header --><div class=\"flex items-center justify-between gap-2 mb-3\"><div class=\"flex items-center gap-2 min-w-0 flex-1\"><div class=\"w-8 h-8 shrink-0 rounded-lg bg-neon-yellow flex items-center justify-center border-2 border-black\"><span class=\"text-lg\">ğŸµ</span></div><div class=\"min-w-0\"><div class=\"text-xs font-black\">Music Player</div><div class=\"text-[10px] text-gray-500 truncate\" x-show=\"pendingRequests.length > 0\" x-text=\"pendingRequests.length + ' request pending'\"></div></div></div><!-- Host Controls --><template x-if=\"amIHost\"><div class=\"flex gap-1 shrink-0\" :class=\"currentNobar ? 'opacity-50 pointer-events-none' : ''\"><button @click=\"toggleMusic()\" x-show=\"currentMusic?.video_id\" :disabled=\"currentNobar\" class=\"w-7 h-7 flex items-center justify-center border-2 border-black rounded bg-neon-green hover:bg-green-400 text-sm font-bold disabled:opacity-50 disabled:cursor-not-allowed\"><span x-show=\"currentMusic?.is_playing\">â¸</span> <span x-show=\"!currentMusic?.is_playing\">â–¶</span></button> <button @click=\"nextMusic()\" x-show=\"musicQueue.length > 0\" :disabled=\"currentNobar\" class=\"w-7 h-7 flex items-center justify-center border-2 border-black rounded bg-blue-300 hover:bg-blue-400 text-sm font-bold disabled:opacity-50 disabled:cursor-not-allowed\" title=\"Next\">â­</button> <button @click=\"stopMusic()\" x-show=\"currentMusic?.video_id\" :disabled=\"currentNobar\" class=\"w-7 h-7 flex items-center justify-center border-2 border-black rounded bg-red-400 hover:bg-red-500 text-sm font-bold text-white disabled:opacity-50 disabled:cursor-not-allowed\">â¹</button></div></template></div><!-- Now Playing --><div x-show=\"currentMusic && currentMusic.video_id\" class=\"mb-3\"><div class=\"bg-white rounded-lg border-2 border-black p-3\"><div class=\"text-[10px] text-purple-600 uppercase font-bold mb-1 flex items-center gap-1\"><span class=\"inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse\"></span> Now Playing</div><div class=\"text-sm font-bold truncate mb-2\" x-text=\"currentMusic?.title || 'Loading...'\"></div><!-- Progress Bar (Seekable for Host) --><div class=\"w-full h-3 bg-gray-300 rounded-full overflow-hidden border border-gray-400 relative\" :class=\"amIHost ? 'cursor-pointer' : ''\" @click=\"seekMusicFromClick($event)\"><div class=\"h-full bg-purple-500 rounded-full transition-all duration-1000 pointer-events-none\" :style=\"`width: ${musicProgress}%`\"></div></div><div class=\"flex justify-between text-[10px] text-gray-600 font-mono mt-1\"><span x-text=\"formatMusicTime(musicCurrentTime)\"></span> <span x-text=\"formatMusicTime(currentMusic?.duration || 0)\"></span></div></div></div><!-- Queue List --><div x-show=\"musicQueue.length > 0\" class=\"mb-4\"><div class=\"text-[10px] text-gray-600 uppercase font-bold mb-2 flex items-center gap-2\"><span>ğŸ“‹ Antrian</span> <span class=\"bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full\" x-text=\"musicQueue.length\"></span></div><div class=\"space-y-1.5 max-h-28 overflow-y-auto pr-1\"><template x-for=\"(item, idx) in musicQueue\" :key=\"item.id\"><div class=\"flex items-center gap-2 text-xs p-2 bg-white rounded-lg border border-gray-200 hover:border-purple-300 transition-colors\"><span class=\"w-5 h-5 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-[10px] font-bold shrink-0\" x-text=\"idx + 1\"></span><div class=\"flex-1 min-w-0\"><div class=\"truncate font-semibold text-gray-800\" x-text=\"item.title || 'YouTube Video'\"></div><div class=\"text-[10px] text-gray-400\" x-text=\"item.requested_by_name\"></div></div></div></template></div></div><!-- Pending Requests (Everyone) --><div x-show=\"pendingRequests.length > 0\"><div class=\"text-[10px] text-red-600 uppercase font-bold mb-2 flex items-center gap-2\"><span>â³ Request Pending</span></div><div class=\"space-y-2 max-h-36 overflow-y-auto pr-1\"><template x-for=\"item in pendingRequests\" :key=\"item.id\"><div class=\"flex items-center gap-2 text-xs p-2.5 bg-gradient-to-r from-red-50 to-orange-50 rounded-lg border-2 border-red-200\"><div class=\"flex-1 min-w-0\"><div class=\"truncate font-semibold text-gray-800\" x-text=\"item.title || 'YouTube Video'\"></div><div class=\"text-[10px] text-gray-500\" x-text=\"'dari ' + item.requested_by_name\"></div></div><!-- Actions (Host Only) --><template x-if=\"amIHost\"><div class=\"flex gap-1.5 shrink-0\"><button @click=\"approveMusicRequest(item.id)\" class=\"w-8 h-8 flex items-center justify-center bg-neon-green text-black font-bold rounded-lg border-2 border-black text-sm hover:bg-green-400 shadow-[2px_2px_0px_0px_#000] hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px] transition-all\">âœ“</button> <button @click=\"rejectMusicRequest(item.id)\" class=\"w-8 h-8 flex items-center justify-center bg-red-500 text-white font-bold rounded-lg border-2 border-black text-sm hover:bg-red-600 shadow-[2px_2px_0px_0px_#000] hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px] transition-all\">âœ—</button></div></template><!-- Status (Non-Host) --><template x-if=\"!amIHost\"><div class=\"px-2 py-1 bg-white/50 rounded text-[10px] text-gray-500 font-bold italic border border-gray-200\">Menunggu...</div></template></div></template></div></div><!-- Volume Control --><div class=\"mt-4 pt-3 border-t border-gray-200\" x-show=\"currentMusic?.video_id\"><div class=\"flex items-center gap-3\"><span class=\"text-sm\">ğŸ”Š</span> <input type=\"range\" min=\"0\" max=\"100\" x-model=\"musicVolume\" @input=\"updateVolume()\" class=\"flex-1 h-2 bg-gray-200 rounded-full appearance-none cursor-pointer accent-purple-600\"> <span class=\"text-[10px] text-gray-500 font-mono w-8\" x-text=\"musicVolume + '%'\"></span></div></div></div></div><!-- Permission Buttons --><div class=\"space-y-2\"><button @click=\"requestBattery\" x-show=\"myBattery < 0\" class=\"w-full px-3 py-2 text-sm font-bold rounded-lg border-4 border-black shadow-brutal-sm bg-white hover:bg-gray-100\">ğŸ”‹ Bagikan Baterai</button></div></div></aside></div><!-- Mobile Nobar Fullscreen Modal --> <!-- Mobile Nobar Wrapper (Persistent for Audio) --> <div x-show=\"currentNobar\" class=\"lg:hidden\"><!-- Persistent Player Container (Fullscreen when Modal Open, 1px when Closed/Background) --><div x-ref=\"nobarFullscreenContainer\" :class=\"[\n\t\t\tshowMobileNobarModal ? 'fixed z-50 bg-black flex items-center justify-center transition-all duration-300' : 'fixed bottom-0 right-0 w-px h-px opacity-0 pointer-events-none',\n\t\t\tnobarIsFullscreen && showMobileNobarModal ? 'inset-0' : 'inset-0'\n\t\t]\" :style=\"nobarIsFullscreen && showMobileNobarModal ? 'transform: rotate(90deg); transform-origin: center center; width: 100vh; height: 100vw; position: fixed; top: 50%; left: 50%; margin-top: -50vw; margin-left: -50vh;' : ''\"><!-- Player Iframe (Persists here) --><div id=\"mobile-nobar-player\" x-ref=\"nobarPlayerMobile\" class=\"w-full h-full\" :style=\"nobarIsFullscreen ? 'width: 100%; height: 100%;' : ''\"></div><!-- Overlay to hide YouTube \"More videos\" when paused --><div x-show=\"currentNobar && !currentNobar.is_playing\" class=\"nobar-paused-overlay\"></div><!-- Full overlay to block clicks to YouTube UI elements (always present) --><div class=\"absolute inset-0 z-[5]\" @click=\"toggleNobarControls()\"></div><!-- Transparent Click Overlay (Shows controls when tapped) - Higher z-index when controls hidden --><div x-show=\"showMobileNobarModal && !nobarControlsVisible\" @click=\"showNobarControls()\" class=\"absolute inset-0 z-[55]\"></div><!-- Overlay UI (Controls/Close) - Only visible when Modal Open AND controls visible --><div x-show=\"showMobileNobarModal && nobarControlsVisible\" x-transition:enter=\"transition ease-out duration-300\" x-transition:enter-start=\"opacity-0\" x-transition:enter-end=\"opacity-100\" x-transition:leave=\"transition ease-in duration-150\" x-transition:leave-start=\"opacity-100\" x-transition:leave-end=\"opacity-0\" class=\"absolute inset-0 pointer-events-none\"><!-- Top Controls (Fullscreen, Minimize & Close) --><div class=\"absolute top-4 right-4 z-[60] flex items-center gap-3 pointer-events-auto\" @click=\"resetNobarControlsTimer()\"><!-- Fullscreen Toggle (Rotate to Landscape) --><button @click=\"toggleNobarFullscreen()\" class=\"w-8 h-8 flex items-center justify-center bg-black/50 text-white rounded-full backdrop-blur-sm active:scale-95 transition-transform\"><span x-show=\"!nobarMaximized\">â›¶</span> <span x-show=\"nobarMaximized\">âœ•</span></button><!-- Minimize Button --><button @click=\"minimizeMobileNobar()\" class=\"w-8 h-8 flex items-center justify-center bg-black/50 text-white rounded-full backdrop-blur-sm active:scale-95 transition-transform\"><span class=\"text-xl font-bold mb-1\">âˆ’</span></button><!-- Close Button --><button @click=\"exitMobileNobar()\" class=\"w-8 h-8 flex items-center justify-center bg-red-500/80 text-white rounded-full backdrop-blur-sm active:scale-95 transition-transform\"><span class=\"text-sm font-bold\">âœ•</span></button></div><!-- Host Request Panel (Top Left) --><template x-if=\"amIHost && (pendingRequests.length > 0 || nobarRequests.length > 0)\"><div class=\"absolute top-4 left-4 z-[60] pointer-events-auto max-w-[70%]\"><div class=\"bg-black/70 backdrop-blur-sm rounded-lg p-2 space-y-2\"><!-- YTM Request --><template x-if=\"pendingRequests.length > 0\"><div class=\"flex items-center gap-2 text-white text-xs\"><span class=\"text-yellow-400\">ğŸµ</span> <span class=\"flex-1 truncate\" x-text=\"pendingRequests[0]?.title\"></span> <button @click.stop=\"approveMusicRequest(pendingRequests[0].id)\" class=\"w-6 h-6 flex items-center justify-center bg-green-500 rounded text-white text-sm font-bold\">âœ“</button> <button @click.stop=\"rejectMusicRequest(pendingRequests[0].id)\" class=\"w-6 h-6 flex items-center justify-center bg-red-500 rounded text-white text-sm font-bold\">âœ•</button> <span x-show=\"pendingRequests.length > 1\" class=\"text-gray-400 text-[10px]\" x-text=\"'+' + (pendingRequests.length - 1)\"></span></div></template><!-- Nobar Request --><template x-if=\"nobarRequests.length > 0\"><div class=\"flex items-center gap-2 text-white text-xs\"><span class=\"text-purple-400\">ğŸ¬</span> <span class=\"flex-1 truncate\" x-text=\"nobarRequests[0]?.title\"></span> <button @click.stop=\"approveNobarRequest(nobarRequests[0].id)\" class=\"w-6 h-6 flex items-center justify-center bg-green-500 rounded text-white text-sm font-bold\">âœ“</button> <button @click.stop=\"rejectNobarRequest(nobarRequests[0].id)\" class=\"w-6 h-6 flex items-center justify-center bg-red-500 rounded text-white text-sm font-bold\">âœ•</button> <span x-show=\"nobarRequests.length > 1\" class=\"text-gray-400 text-[10px]\" x-text=\"'+' + (nobarRequests.length - 1)\"></span></div></template></div></div></template><!-- Controls Overlay --><div class=\"absolute bottom-0 left-0 right-0 z-[60] p-4 bg-gradient-to-t from-black/80 to-transparent text-white pointer-events-auto\" @click=\"resetNobarControlsTimer()\"><div class=\"flex items-center justify-between gap-4 mb-4\"><div class=\"flex-1 min-w-0\"><div class=\"text-lg font-bold truncate\" x-text=\"currentNobar?.title || 'Loading...'\"></div><div class=\"text-sm text-gray-300\" x-text=\"currentNobar?.is_playing ? 'â–¶ Playing' : 'â¸ Paused'\"></div></div><div class=\"flex gap-2\"><template x-if=\"amIHost\"><div class=\"flex gap-2\"><button @click=\"toggleNobar()\" class=\"w-12 h-12 flex items-center justify-center border-2 border-white rounded-full bg-neon-green text-black text-xl font-bold\"><span x-show=\"currentNobar?.is_playing\">â¸</span> <span x-show=\"!currentNobar?.is_playing\">â–¶</span></button> <button @click=\"stopNobar()\" class=\"w-12 h-12 flex items-center justify-center border-2 border-white rounded-full bg-red-500 text-white text-xl font-bold\">â¹</button> <button x-show=\"nobarQueue.length > 0\" @click=\"nextNobar()\" class=\"w-12 h-12 flex items-center justify-center border-2 border-white rounded-full bg-blue-500 text-white text-xl font-bold\">â­</button></div></template></div></div><!-- Progress --><div class=\"mb-4\"><div class=\"w-full h-2 bg-gray-600 rounded-full overflow-hidden\" :class=\"amIHost ? 'cursor-pointer' : ''\" @click=\"seekNobarFromClick($event)\"><div class=\"h-full bg-white rounded-full transition-all duration-1000 pointer-events-none\" :style=\"`width: ${nobarProgress}%`\"></div></div><div class=\"flex justify-between text-xs text-gray-400 font-mono mt-1\"><span x-text=\"formatMusicTime(nobarCurrentTime)\"></span> <span x-text=\"formatMusicTime(currentNobar?.duration || 0)\"></span></div></div><!-- Volume --><div class=\"flex items-center gap-3 mb-4\"><span class=\"text-lg\">ğŸ”Š</span> <input type=\"range\" min=\"0\" max=\"100\" x-model=\"nobarVolume\" @input=\"updateNobarVolume()\" class=\"flex-1 h-2 bg-gray-200 rounded-full appearance-none cursor-pointer accent-purple-600\"> <span class=\"text-xs text-gray-400 font-mono w-10\" x-text=\"nobarVolume + '%'\"></span></div><!-- Queue List --><div x-show=\"nobarQueue.length > 0\" class=\"mt-2\"><div class=\"text-xs font-bold text-purple-300 uppercase mb-2\">ğŸ“‹ Antrian (<span x-text=\"nobarQueue.length\"></span>)</div><div class=\"space-y-1.5 max-h-24 overflow-y-auto\"><template x-for=\"(item, idx) in nobarQueue\" :key=\"item.id\"><div class=\"flex items-center gap-2 text-xs p-2 bg-white/10 rounded-lg\"><span class=\"w-5 h-5 rounded-full bg-purple-500 text-white flex items-center justify-center text-[10px] font-bold\" x-text=\"idx + 1\"></span><div class=\"flex-1 min-w-0\"><div class=\"truncate text-white\" x-text=\"item.title || 'Video'\"></div><div class=\"text-[10px] text-gray-400\" x-text=\"item.requested_by_name\"></div></div></div></template></div></div></div></div></div></div><!-- Toast Notifications --> <div x-show=\"toast.show\" x-transition:enter=\"transition ease-out duration-300\" x-transition:enter-start=\"opacity-0 -translate-y-4\" x-transition:enter-end=\"opacity-100 translate-y-0\" x-transition:leave=\"transition ease-in duration-200\" x-transition:leave-start=\"opacity-100 translate-y-0\" x-transition:leave-end=\"opacity-0 -translate-y-4\" class=\"fixed top-20 left-1/2 -translate-x-1/2 z-50 px-4 py-2 rounded-lg border-2 border-black shadow-brutal-sm font-bold text-sm flex items-center gap-2 whitespace-nowrap\" :class=\"toast.type === 'success' ? 'bg-neon-green text-black' : 'bg-red-500 text-white'\"><span x-text=\"toast.icon\"></span> <span x-text=\"toast.message\"></span></div><!-- Mobile Unified Floating Player (Nobar priority > YTM) --> <div x-show=\"(currentNobar && currentNobar.video_id) || (currentMusic && currentMusic.video_id && !currentNobar) || (pendingRequests.length > 0 || nobarRequests.length > 0)\" x-transition:enter=\"transition ease-out duration-300\" x-transition:enter-start=\"translate-y-full opacity-0\" x-transition:enter-end=\"translate-y-0 opacity-100\" x-transition:leave=\"transition ease-in duration-200\" x-transition:leave-start=\"translate-y-0 opacity-100\" x-transition:leave-end=\"translate-y-full opacity-0\" class=\"fixed bottom-0 left-0 right-0 z-40 lg:hidden p-2 pb-safe\"><!-- NOBAR Floating Bar (Priority) --><template x-if=\"currentNobar && currentNobar.video_id\"><div class=\"bg-gradient-to-r from-purple-600 to-indigo-600 border-4 border-black rounded-xl shadow-brutal-sm overflow-hidden mx-2\" @click=\"openMobileNobar()\"><!-- Progress bar at top --><div class=\"h-1 bg-purple-400\"><div class=\"h-full bg-white transition-all duration-1000\" :style=\"`width: ${nobarProgress}%`\"></div></div><div class=\"p-2 flex items-center gap-3\"><!-- Icon --><div class=\"w-10 h-10 shrink-0 rounded-lg bg-white flex items-center justify-center border-2 border-black\"><span class=\"text-lg\" :class=\"currentNobar?.is_playing ? 'animate-pulse' : ''\">ğŸ¬</span></div><!-- Video Info --><div class=\"flex-1 min-w-0 text-white\"><div class=\"text-xs font-bold truncate\" x-text=\"currentNobar?.title || 'Loading...'\"></div><div class=\"text-[10px] text-purple-200 flex items-center gap-1\"><span class=\"inline-block w-1.5 h-1.5 rounded-full\" :class=\"currentNobar?.is_playing ? 'bg-green-400 animate-pulse' : 'bg-gray-300'\"></span> <span x-text=\"currentNobar?.is_playing ? 'Nobar Playing' : 'Paused'\"></span> <span class=\"text-purple-300\">â€¢</span> <span x-text=\"formatMusicTime(nobarCurrentTime) + ' / ' + formatMusicTime(currentNobar?.duration || 0)\"></span></div></div><!-- Viewer Count (Mobile) --><div class=\"flex items-center gap-1 text-white bg-black/20 px-2 py-1 rounded-lg ml-2\" @click.stop=\"showNobarViewers = !showNobarViewers\"><span class=\"text-xs\">ğŸ‘ï¸</span> <span class=\"text-[10px] font-bold\" x-text=\"nobarViewers.length\"></span></div><!-- Mobile Viewer List Overlay --><div x-show=\"showNobarViewers\" @click.stop=\"showNobarViewers = false\" x-transition:enter=\"transition ease-out duration-200\" x-transition:enter-start=\"opacity-0 translate-y-2\" x-transition:enter-end=\"opacity-100 translate-y-0\" x-transition:leave=\"transition ease-in duration-150\" x-transition:leave-start=\"opacity-100 translate-y-0\" x-transition:leave-end=\"opacity-0 translate-y-2\" class=\"absolute bottom-16 right-2 w-48 bg-white border-2 border-black shadow-brutal p-2 z-[60]\"><div class=\"text-[10px] font-bold uppercase border-b-2 border-black mb-1 pb-1 text-center text-black\">Sedang Menonton</div><div class=\"max-h-32 overflow-y-auto space-y-1\"><template x-for=\"viewer in nobarViewers\" :key=\"viewer.id\"><div class=\"flex items-center gap-2 text-xs\"><span class=\"w-2 h-2 rounded-full border border-black\" :style=\"`background-color: ${viewer.persona_color}`\"></span> <span class=\"truncate font-bold text-black\" x-text=\"viewer.persona_name\"></span></div></template></div></div><!-- Quick Controls (Host Only) --><template x-if=\"amIHost\"><div class=\"flex gap-1 shrink-0\"><button @click.stop=\"toggleNobar()\" class=\"w-9 h-9 flex items-center justify-center border-2 border-black rounded-lg bg-neon-green hover:bg-green-400 text-base font-bold\"><span x-show=\"currentNobar?.is_playing\">â¸</span> <span x-show=\"!currentNobar?.is_playing\">â–¶</span></button> <button @click.stop=\"stopNobar()\" class=\"w-9 h-9 flex items-center justify-center border-2 border-black rounded-lg bg-red-400 hover:bg-red-500 text-base font-bold text-white\">â¹</button></div></template><!-- Expand indicator for non-host --><template x-if=\"!amIHost\"><div class=\"text-white text-lg\">â€º</div></template></div><!-- Queue indicator --><div x-show=\"nobarQueue.length > 0 || (nobarRequests.length > 0 || pendingRequests.length > 0)\" class=\"px-3 py-1.5 bg-purple-700/50 border-t border-purple-400 flex items-center gap-2 text-[10px] text-white flex-wrap\"><span x-show=\"nobarQueue.length > 0\">ğŸ“‹ <span x-text=\"nobarQueue.length\"></span> dalam antrian</span> <span x-show=\"nobarRequests.length > 0\" class=\"text-yellow-300 font-bold animate-pulse\">ğŸ¬ <span x-text=\"nobarRequests.length\"></span> nobar request</span> <span x-show=\"pendingRequests.length > 0\" class=\"text-orange-300 font-bold animate-pulse\">ğŸµ <span x-text=\"pendingRequests.length\"></span> musik request</span></div></div></template><!-- YTM Floating Bar (Fallback when no Nobar) --><template x-if=\"currentMusic && currentMusic.video_id && !currentNobar\"><div class=\"bg-white border-4 border-black rounded-xl shadow-brutal-sm overflow-hidden mx-2\" @click=\"showMobilePlayerModal = true\"><!-- Progress bar at top --><div class=\"h-1 bg-gray-200\"><div class=\"h-full bg-purple-500 transition-all duration-1000\" :style=\"`width: ${musicProgress}%`\"></div></div><div class=\"p-2 flex items-center gap-3\"><!-- Icon --><div class=\"w-10 h-10 shrink-0 rounded-lg bg-neon-yellow flex items-center justify-center border-2 border-black\"><span class=\"text-lg\" :class=\"currentMusic?.is_playing ? 'animate-pulse' : ''\">ğŸµ</span></div><!-- Song Info --><div class=\"flex-1 min-w-0\"><div class=\"text-xs font-bold truncate\" x-text=\"currentMusic?.title || 'Loading...'\"></div><div class=\"text-[10px] text-gray-500 flex items-center gap-1\"><span class=\"inline-block w-1.5 h-1.5 rounded-full\" :class=\"currentMusic?.is_playing ? 'bg-green-500 animate-pulse' : 'bg-gray-400'\"></span> <span x-text=\"currentMusic?.is_playing ? 'Now Playing' : 'Paused'\"></span> <span class=\"text-gray-400\">â€¢</span> <span x-text=\"formatMusicTime(musicCurrentTime) + ' / ' + formatMusicTime(currentMusic?.duration || 0)\"></span></div></div><!-- Quick Controls (Host Only) --><template x-if=\"amIHost\"><div class=\"flex gap-1 shrink-0\"><button @click.stop=\"toggleMusic()\" class=\"w-9 h-9 flex items-center justify-center border-2 border-black rounded-lg bg-neon-green hover:bg-green-400 text-base font-bold\"><span x-show=\"currentMusic?.is_playing\">â¸</span> <span x-show=\"!currentMusic?.is_playing\">â–¶</span></button> <button @click.stop=\"stopMusic()\" class=\"w-9 h-9 flex items-center justify-center border-2 border-black rounded-lg bg-red-400 hover:bg-red-500 text-base font-bold text-white\">â¹</button></div></template><!-- Expand indicator for non-host --><template x-if=\"!amIHost\"><div class=\"text-gray-400 text-lg\">â€º</div></template></div><!-- Queue indicator --><div x-show=\"musicQueue.length > 0 || (pendingRequests.length > 0 || nobarRequests.length > 0)\" class=\"px-3 py-1.5 bg-gray-100 border-t border-gray-200 flex items-center gap-2 text-[10px] flex-wrap\"><span x-show=\"musicQueue.length > 0\" class=\"text-gray-600\">ğŸ“‹ <span x-text=\"musicQueue.length\"></span> dalam antrian</span> <span x-show=\"pendingRequests.length > 0\" class=\"text-red-500 font-bold animate-pulse\">ğŸµ <span x-text=\"pendingRequests.length\"></span> request</span> <span x-show=\"nobarRequests.length > 0\" class=\"text-purple-600 font-bold animate-pulse\">ğŸ¬ <span x-text=\"nobarRequests.length\"></span> nobar request</span></div></div></template><!-- Host-Only: Pending Requests Bar (when no music/nobar playing) --><template x-if=\"!currentNobar?.video_id && !currentMusic?.video_id && (pendingRequests.length > 0 || nobarRequests.length > 0)\"><div class=\"bg-gradient-to-r from-orange-500 to-red-500 border-4 border-black rounded-xl shadow-brutal-sm overflow-hidden mx-2\"><div class=\"p-3\"><div class=\"flex items-center gap-3 mb-3\"><div class=\"w-10 h-10 shrink-0 rounded-lg bg-white flex items-center justify-center border-2 border-black\"><span class=\"text-lg animate-pulse\">ğŸ“¬</span></div><div class=\"flex-1 min-w-0 text-white\"><div class=\"text-sm font-bold\">Request Masuk!</div><div class=\"text-[10px] text-orange-100\"><span x-show=\"pendingRequests.length > 0\" x-text=\"pendingRequests.length + ' musik'\"></span> <span x-show=\"pendingRequests.length > 0 && nobarRequests.length > 0\">â€¢ </span> <span x-show=\"nobarRequests.length > 0\" x-text=\"nobarRequests.length + ' nobar'\"></span></div></div></div><!-- First Pending Request (Quick Action) --><template x-if=\"pendingRequests.length > 0\"><div class=\"bg-white/20 rounded-lg p-2 mb-2\"><div class=\"flex items-center gap-2\"><span class=\"text-white\">ğŸµ</span><div class=\"flex-1 min-w-0 text-white\"><div class=\"text-xs font-bold truncate\" x-text=\"pendingRequests[0]?.title || 'Video'\"></div><div class=\"text-[10px] text-orange-100\" x-text=\"'dari ' + pendingRequests[0]?.requested_by_name\"></div></div><template x-if=\"amIHost\"><div class=\"flex gap-1 shrink-0\"><button @click.stop=\"approveMusicRequest(pendingRequests[0].id)\" class=\"w-8 h-8 flex items-center justify-center bg-neon-green text-black font-bold rounded-lg border-2 border-black text-sm\">âœ“</button> <button @click.stop=\"rejectMusicRequest(pendingRequests[0].id)\" class=\"w-8 h-8 flex items-center justify-center bg-red-600 text-white font-bold rounded-lg border-2 border-black text-sm\">âœ•</button></div></template></div></div></template><!-- First Nobar Request (Quick Action) --><template x-if=\"nobarRequests.length > 0\"><div class=\"bg-white/20 rounded-lg p-2\"><div class=\"flex items-center gap-2\"><span class=\"text-white\">ğŸ¬</span><div class=\"flex-1 min-w-0 text-white\"><div class=\"text-xs font-bold truncate\" x-text=\"nobarRequests[0]?.title || 'Video'\"></div><div class=\"text-[10px] text-orange-100\" x-text=\"'dari ' + nobarRequests[0]?.requested_by_name\"></div></div><template x-if=\"amIHost\"><div class=\"flex gap-1 shrink-0\"><button @click.stop=\"approveNobarRequest(nobarRequests[0].id)\" class=\"w-8 h-8 flex items-center justify-center bg-neon-green text-black font-bold rounded-lg border-2 border-black text-sm\">âœ“</button> <button @click.stop=\"rejectNobarRequest(nobarRequests[0].id)\" class=\"w-8 h-8 flex items-center justify-center bg-red-600 text-white font-bold rounded-lg border-2 border-black text-sm\">âœ•</button></div></template></div></div></template></div></div></template></div><!-- Mobile Player Modal --> <div x-show=\"showMobilePlayerModal\" x-transition:enter=\"transition ease-out duration-300\" x-transition:enter-start=\"opacity-0\" x-transition:enter-end=\"opacity-100\" x-transition:leave=\"transition ease-in duration-200\" x-transition:leave-start=\"opacity-100\" x-transition:leave-end=\"opacity-0\" class=\"fixed inset-0 z-50 bg-black/60 lg:hidden\" @click=\"showMobilePlayerModal = false\"><div class=\"absolute bottom-0 left-0 right-0 bg-white border-t-4 border-black rounded-t-2xl max-h-[80vh] overflow-y-auto\" x-transition:enter=\"transition ease-out duration-300\" x-transition:enter-start=\"translate-y-full\" x-transition:enter-end=\"translate-y-0\" x-transition:leave=\"transition ease-in duration-200\" x-transition:leave-start=\"translate-y-0\" x-transition:leave-end=\"translate-y-full\" @click.stop><!-- Handle --><div class=\"flex justify-center py-2\"><div class=\"w-12 h-1 bg-gray-300 rounded-full\"></div></div><div class=\"p-4\"><!-- Now Playing --><div class=\"text-center mb-4\"><div class=\"w-16 h-16 mx-auto rounded-xl bg-neon-yellow flex items-center justify-center border-3 border-black mb-3\"><span class=\"text-3xl\" :class=\"currentMusic?.is_playing ? 'animate-bounce' : ''\">ğŸµ</span></div><div class=\"text-lg font-black truncate\" x-text=\"currentMusic?.title || 'Loading...'\"></div><div class=\"text-sm text-gray-500\" x-text=\"currentMusic?.is_playing ? 'â–¶ Now Playing' : 'â¸ Paused'\"></div></div><!-- Progress --><div class=\"mb-4\"><div class=\"w-full h-3 bg-gray-200 rounded-full overflow-hidden border border-gray-300\" :class=\"amIHost ? 'cursor-pointer' : ''\" @click=\"seekMusicFromClick($event)\"><div class=\"h-full bg-purple-500 rounded-full transition-all duration-1000 pointer-events-none\" :style=\"`width: ${musicProgress}%`\"></div></div><div class=\"flex justify-between text-xs text-gray-500 font-mono mt-1\"><span x-text=\"formatMusicTime(musicCurrentTime)\"></span> <span x-text=\"formatMusicTime(currentMusic?.duration || 0)\"></span></div></div><!-- Controls (Host Only) --><template x-if=\"amIHost\"><div class=\"flex justify-center gap-3 mb-4\" :class=\"currentNobar ? 'opacity-50 pointer-events-none' : ''\"><button @click=\"toggleMusic()\" :disabled=\"currentNobar\" class=\"w-14 h-14 flex items-center justify-center border-3 border-black rounded-xl bg-neon-green hover:bg-green-400 text-2xl font-bold shadow-brutal-sm disabled:opacity-50\"><span x-show=\"currentMusic?.is_playing\">â¸</span> <span x-show=\"!currentMusic?.is_playing\">â–¶</span></button> <button @click=\"nextMusic()\" x-show=\"musicQueue.length > 0\" :disabled=\"currentNobar\" class=\"w-14 h-14 flex items-center justify-center border-3 border-black rounded-xl bg-blue-300 hover:bg-blue-400 text-2xl font-bold shadow-brutal-sm disabled:opacity-50\">â­</button> <button @click=\"stopMusic()\" :disabled=\"currentNobar\" class=\"w-14 h-14 flex items-center justify-center border-3 border-black rounded-xl bg-red-400 hover:bg-red-500 text-2xl font-bold text-white shadow-brutal-sm disabled:opacity-50\">â¹</button></div></template><!-- Volume --><div class=\"flex items-center gap-3 mb-4 px-2\"><span class=\"text-lg\">ğŸ”Š</span> <input type=\"range\" min=\"0\" max=\"100\" x-model=\"musicVolume\" @input=\"updateVolume()\" class=\"flex-1 h-2 bg-gray-200 rounded-full appearance-none cursor-pointer accent-purple-600\"> <span class=\"text-xs text-gray-500 font-mono w-10\" x-text=\"musicVolume + '%'\"></span></div><!-- Queue --><div x-show=\"musicQueue.length > 0\" class=\"mb-4\"><div class=\"text-xs font-bold text-gray-600 uppercase mb-2\">ğŸ“‹ Antrian (<span x-text=\"musicQueue.length\"></span>)</div><div class=\"space-y-1.5 max-h-32 overflow-y-auto\"><template x-for=\"(item, idx) in musicQueue\" :key=\"item.id\"><div class=\"flex items-center gap-2 text-sm p-2 bg-gray-50 rounded-lg border border-gray-200\"><span class=\"w-5 h-5 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs font-bold\" x-text=\"idx + 1\"></span><div class=\"flex-1 min-w-0\"><div class=\"truncate font-medium\" x-text=\"item.title || 'YouTube Video'\"></div><div class=\"text-[10px] text-gray-400\" x-text=\"item.requested_by_name\"></div></div></div></template></div></div><!-- Pending Requests (Everyone) --><template x-if=\"pendingRequests.length > 0\"><div class=\"mb-4\"><div class=\"text-xs font-bold text-red-600 uppercase mb-2\">â³ Request Pending (<span x-text=\"pendingRequests.length\"></span>)</div><div class=\"space-y-2 max-h-40 overflow-y-auto\"><template x-for=\"item in pendingRequests\" :key=\"item.id\"><div class=\"flex items-center gap-2 text-sm p-2.5 bg-red-50 rounded-lg border-2 border-red-200\"><div class=\"flex-1 min-w-0\"><div class=\"truncate font-medium\" x-text=\"item.title || 'YouTube Video'\"></div><div class=\"text-[10px] text-gray-500\" x-text=\"'dari ' + item.requested_by_name\"></div></div><!-- Actions (Host Only) --><template x-if=\"amIHost\"><div class=\"flex gap-1.5 shrink-0\"><button @click=\"approveMusicRequest(item.id)\" class=\"w-10 h-10 flex items-center justify-center bg-neon-green text-black font-bold rounded-lg border-2 border-black text-lg\">âœ“</button> <button @click=\"rejectMusicRequest(item.id)\" class=\"w-10 h-10 flex items-center justify-center bg-red-500 text-white font-bold rounded-lg border-2 border-black text-lg\">âœ—</button></div></template><!-- Status (Non-Host) --><template x-if=\"!amIHost\"><div class=\"px-2 py-1 bg-white/50 rounded text-[10px] text-gray-500 font-bold italic border border-gray-200\">Menunggu...</div></template></div></template></div></div></template><!-- Nobar Requests (Host Only) --><template x-if=\"amIHost && nobarRequests.length > 0\"><div class=\"mb-4\"><div class=\"text-xs font-bold text-purple-600 uppercase mb-2\">ğŸ¬ Request Nobar (<span x-text=\"nobarRequests.length\"></span>)</div><div class=\"space-y-2 max-h-40 overflow-y-auto\"><template x-for=\"item in nobarRequests\" :key=\"item.id\"><div class=\"flex items-center gap-2 text-sm p-2.5 bg-purple-50 rounded-lg border-2 border-purple-200\"><div class=\"flex-1 min-w-0\"><div class=\"truncate font-medium\" x-text=\"item.title || 'YouTube Video'\"></div><div class=\"text-[10px] text-gray-500\" x-text=\"'dari ' + item.requested_by_name\"></div></div><div class=\"flex gap-1.5 shrink-0\"><button @click=\"approveNobarRequest(item.id)\" class=\"w-10 h-10 flex items-center justify-center bg-neon-green text-black font-bold rounded-lg border-2 border-black text-lg\">âœ“</button> <button @click=\"rejectNobarRequest(item.id)\" class=\"w-10 h-10 flex items-center justify-center bg-red-500 text-white font-bold rounded-lg border-2 border-black text-lg\">âœ—</button></div></div></template></div></div></template></div></div></div><!-- Custom Confirm Modal (Neobrutalism Style) --> <div x-show=\"confirmModal.show\" x-transition:enter=\"transition ease-out duration-200\" x-transition:enter-start=\"opacity-0\" x-transition:enter-end=\"opacity-100\" x-transition:leave=\"transition ease-in duration-150\" x-transition:leave-start=\"opacity-100\" x-transition:leave-end=\"opacity-0\" class=\"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50\" @keydown.escape.window=\"confirmModal.show && confirmModal.onCancel()\"><div x-show=\"confirmModal.show\" x-transition:enter=\"transition ease-out duration-200\" x-transition:enter-start=\"opacity-0 scale-95\" x-transition:enter-end=\"opacity-100 scale-100\" x-transition:leave=\"transition ease-in duration-150\" x-transition:leave-start=\"opacity-100 scale-100\" x-transition:leave-end=\"opacity-0 scale-95\" class=\"w-72 bg-white border-4 border-black rounded-xl shadow-brutal p-4\" @click.stop><!-- Icon --><div class=\"text-center mb-2\"><span class=\"text-2xl\" x-text=\"confirmModal.icon || 'âš ï¸'\"></span></div><!-- Title --><h3 class=\"text-base font-black text-center mb-1 uppercase\" x-text=\"confirmModal.title || 'Konfirmasi'\"></h3><!-- Message --><p class=\"text-center text-gray-600 text-sm mb-4\" x-text=\"confirmModal.message\"></p><!-- Buttons --><div class=\"flex gap-2\"><button x-show=\"!confirmModal.hideCancel\" @click=\"confirmModal.onCancel()\" class=\"flex-1 px-3 py-2 text-sm font-bold uppercase rounded-lg border-2 border-black bg-white shadow-[4px_4px_0px_0px_#000] transition-all hover:bg-gray-100 hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-[2px_2px_0px_0px_#000] active:translate-x-[4px] active:translate-y-[4px] active:shadow-none active:scale-95\">Batal</button> <button @click=\"confirmModal.onConfirm()\" class=\"flex-1 px-3 py-2 text-sm font-bold uppercase rounded-lg border-2 border-black shadow-[4px_4px_0px_0px_#000] transition-all hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-[2px_2px_0px_0px_#000] active:translate-x-[4px] active:translate-y-[4px] active:shadow-none active:scale-95\" :class=\"confirmModal.type === 'danger' ? 'bg-red-500 text-white hover:bg-red-600' : 'bg-neon-yellow hover:bg-yellow-400'\"><span x-text=\"confirmModal.confirmText || 'Ya'\"></span></button></div></div></div><!-- Nobar PiP Window (Draggable & Resizable) --> <div x-show=\"showNobarModal && currentNobar\" x-transition:enter=\"transition ease-out duration-200\" x-transition:enter-start=\"opacity-0 scale-95\" x-transition:enter-end=\"opacity-100 scale-100\" x-transition:leave=\"transition ease-in duration-150\" x-transition:leave-start=\"opacity-100 scale-100\" x-transition:leave-end=\"opacity-0 scale-95\" x-ref=\"nobarWindow\" class=\"fixed z-50 bg-black rounded-xl border-4 border-white/30 shadow-2xl overflow-hidden flex flex-col hidden lg:flex\" :class=\"nobarMaximized ? 'inset-4' : ''\" :style=\"!nobarMaximized ? `left: ${nobarPos.x}px; top: ${nobarPos.y}px; width: ${nobarSize.w}px; height: ${nobarSize.h}px;` : ''\" @mousedown=\"startNobarDrag($event)\" @mouseenter=\"showDesktopNobarControls()\" @mouseleave=\"hideDesktopNobarControls()\"><!-- Header (Draggable Handle) - Auto-hide --><div x-show=\"desktopNobarControlsVisible\" x-transition:enter=\"transition ease-out duration-200\" x-transition:enter-start=\"opacity-0 -translate-y-full\" x-transition:enter-end=\"opacity-100 translate-y-0\" x-transition:leave=\"transition ease-in duration-150\" x-transition:leave-start=\"opacity-100 translate-y-0\" x-transition:leave-end=\"opacity-0 -translate-y-full\" class=\"nobar-drag-handle cursor-move bg-gradient-to-r from-purple-600 to-pink-500 px-3 py-2 flex items-center justify-between gap-2 shrink-0\"><div class=\"flex items-center gap-2 min-w-0\"><span class=\"text-lg\">ğŸ¬</span> <span class=\"text-white font-bold text-sm truncate\" x-text=\"currentNobar?.title || 'Nobar'\"></span></div><div class=\"flex items-center gap-1 shrink-0\"><span class=\"text-white/70 text-xs font-mono\" x-text=\"formatMusicTime(nobarCurrentTime) + '/' + formatMusicTime(currentNobar?.duration || 0)\"></span><!-- Minimize: keep playing in background --><button @click=\"minimizeNobar()\" @mousedown.stop class=\"w-6 h-6 flex items-center justify-center text-white hover:bg-white/20 rounded text-lg font-bold\" title=\"Minimize (tetap putar di background)\">âˆ’</button><!-- Maximize/Restore --><button @click=\"nobarMaximized = !nobarMaximized\" @mousedown.stop class=\"w-6 h-6 flex items-center justify-center text-white hover:bg-white/20 rounded\" title=\"Maximize/Restore\"><span x-show=\"!nobarMaximized\">â¬œ</span> <span x-show=\"nobarMaximized\">ğŸ——</span></button><!-- Close: stop playing, destroy player to save data --><button @click=\"closeNobar()\" @mousedown.stop class=\"w-6 h-6 flex items-center justify-center text-white hover:bg-red-500 rounded\" title=\"Tutup (hemat data)\">âœ•</button><div class=\"h-6 w-px bg-white/20 mx-1\"></div><!-- Active Viewers (Desktop) --><div class=\"relative group flex items-center gap-1 cursor-help px-2 py-0.5 rounded hover:bg-white/10\" @mouseenter=\"showNobarViewers = true\" @mouseleave=\"showNobarViewers = false\"><span class=\"text-sm\">ğŸ‘ï¸</span> <span class=\"text-xs font-bold font-mono\" x-text=\"nobarViewers.length\"></span><!-- Tooltip --><div x-show=\"showNobarViewers && nobarViewers.length > 0\" x-transition.opacity.duration.200ms class=\"absolute top-full right-0 mt-2 w-48 bg-white border-2 border-black shadow-brutal p-2 z-[60] pointer-events-none\"><div class=\"text-[10px] font-bold uppercase border-b-2 border-black mb-1 pb-1 text-center\">Sedang Menonton</div><div class=\"max-h-32 overflow-y-auto space-y-1\"><template x-for=\"viewer in nobarViewers\" :key=\"viewer.id\"><div class=\"flex items-center gap-2 text-xs\"><span class=\"w-2 h-2 rounded-full border border-black\" :style=\"`background-color: ${viewer.persona_color}`\"></span> <span class=\"truncate font-bold text-black\" x-text=\"viewer.persona_name\"></span></div></template></div></div></div></div></div><!-- Video Player --><div class=\"relative bg-black flex-1 min-h-0\"><div id=\"nobar-player\" class=\"w-full h-full\"></div><!-- Full overlay to block clicks to YouTube UI elements --><div class=\"absolute inset-0 z-[5]\"></div><!-- Overlay to hide YouTube \"More videos\" when paused --><div x-show=\"currentNobar && !currentNobar.is_playing\" class=\"nobar-paused-overlay\"></div></div><!-- Controls - Auto-hide --><div x-show=\"desktopNobarControlsVisible\" x-transition:enter=\"transition ease-out duration-200\" x-transition:enter-start=\"opacity-0 translate-y-full\" x-transition:enter-end=\"opacity-100 translate-y-0\" x-transition:leave=\"transition ease-in duration-150\" x-transition:leave-start=\"opacity-100 translate-y-0\" x-transition:leave-end=\"opacity-0 translate-y-full\" class=\"bg-gray-900 p-2 space-y-2 shrink-0\"><!-- Progress Bar (Seekable by Host) --><div class=\"relative w-full h-2 bg-white/20 rounded-full cursor-pointer group\" @click=\"amIHost && seekNobarFromClick($event)\" :class=\"amIHost ? 'cursor-pointer' : 'cursor-default'\"><div class=\"h-full bg-purple-500 rounded-full transition-all\" :style=\"`width: ${nobarProgress}%`\"></div><template x-if=\"amIHost\"><div class=\"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white rounded-full border-2 border-purple-500 opacity-0 group-hover:opacity-100 transition-opacity\" :style=\"`left: calc(${nobarProgress}% - 6px)`\"></div></template></div><div class=\"flex items-center justify-between gap-2\"><!-- Left: Host Controls or Info --><div class=\"flex items-center gap-1\"><template x-if=\"amIHost\"><div class=\"flex gap-1\"><button @click=\"toggleNobar()\" @mousedown.stop class=\"w-8 h-8 flex items-center justify-center bg-neon-green hover:bg-green-400 text-black font-bold rounded-lg border-2 border-white text-sm\"><span x-show=\"currentNobar?.is_playing\">â¸</span> <span x-show=\"!currentNobar?.is_playing\">â–¶</span></button> <button @click=\"nextNobar()\" @mousedown.stop x-show=\"nobarQueue && nobarQueue.length > 0\" class=\"w-8 h-8 flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-lg border-2 border-white text-sm\" title=\"Putar Selanjutnya\">â­</button> <button @click=\"stopNobar()\" @mousedown.stop class=\"w-8 h-8 flex items-center justify-center bg-red-500 hover:bg-red-600 text-white font-bold rounded-lg border-2 border-white text-sm\">â¹</button><!-- Party Mode Dropdown (Desktop Nobar) - CLICK BASED --><div class=\"relative\" x-data=\"{ partyOpen: false }\" @mousedown.stop @click.outside=\"partyOpen = false\"><button @click=\"partyOpen = !partyOpen\" class=\"w-8 h-8 flex items-center justify-center bg-yellow-400 hover:bg-yellow-500 text-black font-bold rounded-lg border-2 border-white text-sm\">ğŸ‰</button><!-- Dropup Menu --><div x-show=\"partyOpen\" x-transition class=\"absolute bottom-full left-0 mb-2 w-32 bg-white border-2 border-black shadow-brutal p-1 z-50\"><div class=\"text-[10px] font-bold text-center border-b border-black mb-1 p-1\">PARTY MODE</div><button @click=\"setPartyMode('normal'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-gray-100 font-bold block\">ğŸš« Normal</button> <button @click=\"setPartyMode('chill'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-purple-100 text-purple-700 font-bold block\">ğŸŒ™ Chill</button><!-- Rave Submenu - CLICK BASED --><div class=\"relative\" x-data=\"{ raveOpen: false }\"><button @click=\"raveOpen = !raveOpen\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-red-100 text-red-600 font-bold flex justify-between items-center\"><span>âš¡ Rave</span> <span class=\"text-[8px]\" x-text=\"raveOpen ? 'â–¼' : 'â–¶'\"></span></button><div x-show=\"raveOpen\" x-transition class=\"absolute left-full top-0 ml-1 w-28 bg-white border-2 border-black shadow-brutal p-1 z-50\"><button @click=\"setPartyMode('rave-slow'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-blue-100 text-blue-600 font-bold block\">ğŸµ Slow (80)</button> <button @click=\"setPartyMode('rave-medium'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-green-100 text-green-600 font-bold block\">ğŸ¶ Medium (120)</button> <button @click=\"setPartyMode('rave-fast'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-orange-100 text-orange-600 font-bold block\">âš¡ Fast (140)</button> <button @click=\"setPartyMode('rave-insane'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-red-100 text-red-600 font-bold block\">ğŸ”¥ Insane (170)</button></div></div><button @click=\"setPartyMode('galau'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-pink-100 text-pink-600 font-bold block\">ğŸ’– Galau</button> <button @click=\"setPartyMode('disco'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-yellow-100 text-yellow-600 font-bold block\">ğŸ•º Disco</button> <button @click=\"setPartyMode('horror'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-gray-800 hover:text-white font-bold block\">ğŸ‘» Horror</button> <button @click=\"setPartyMode('zen'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-green-100 text-green-700 font-bold block\">ğŸŒ¿ Zen</button> <button @click=\"setPartyMode('cinema'); partyOpen = false\" class=\"w-full text-left px-2 py-1 text-xs hover:bg-orange-100 text-orange-700 font-bold block\">ğŸ¬ Cinema</button></div></div></div></template><template x-if=\"!amIHost\"><span class=\"text-white/50 text-xs\">ğŸ¬ Host controls</span></template></div><!-- Right: Volume Control (Everyone) --><div class=\"flex items-center gap-2\"><span class=\"text-white/70 text-sm\">ğŸ”Š</span> <input type=\"range\" min=\"0\" max=\"100\" x-model=\"nobarVolume\" @input=\"updateNobarVolume()\" @mousedown.stop class=\"w-20 h-1.5 bg-white/30 rounded-full appearance-none cursor-pointer accent-purple-500\"> <span class=\"text-white/50 text-xs w-8\" x-text=\"nobarVolume + '%'\"></span></div></div></div><!-- Resize Handle (Bottom Right Corner) --><div x-show=\"!nobarMaximized\" class=\"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize\" @mousedown.stop=\"startNobarResize($event)\"><svg class=\"w-full h-full text-white/50\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M22 22H20V20H22V22ZM22 18H18V22H22V18ZM18 22H14V18H18V22Z\"></path></svg></div></div><!-- YouTube Player (offscreen but visible for audio) --> <div id=\"yt-player-container\" style=\"position: fixed; left: -9999px; top: 0; width: 1px; height: 1px; overflow: hidden;\"></div><!-- Nobar Request Sent Modal --> <div x-show=\"showNobarRequestSentModal\" x-transition:enter=\"transition ease-out duration-300\" x-transition:enter-start=\"opacity-0 transform scale-90\" x-transition:enter-end=\"opacity-100 transform scale-100\" x-transition:leave=\"transition ease-in duration-200\" x-transition:leave-start=\"opacity-100 transform scale-100\" x-transition:leave-end=\"opacity-0 transform scale-90\" class=\"fixed inset-0 z-[100] flex items-center justify-center pointer-events-none\"><div class=\"bg-white border-4 border-black p-6 rounded-xl shadow-brutal text-center transform rotate-2 max-w-sm mx-4\"><div class=\"text-4xl mb-4\">ğŸ“¨</div><h3 class=\"text-xl font-bold mb-2\">Permintaan Terkirim!</h3><p class=\"text-gray-600\">Host akan mendapatkan notifikasi permintaan nobar kamu.</p></div></div><!-- YTM Request Sent Modal --> <div x-show=\"showYtmRequestSentModal\" x-transition:enter=\"transition ease-out duration-300\" x-transition:enter-start=\"opacity-0 transform scale-90\" x-transition:enter-end=\"opacity-100 transform scale-100\" x-transition:leave=\"transition ease-in duration-200\" x-transition:leave-start=\"opacity-100 transform scale-100\" x-transition:leave-end=\"opacity-0 transform scale-90\" class=\"fixed inset-0 z-[100] flex items-center justify-center pointer-events-none\"><div class=\"bg-white border-4 border-black p-6 rounded-xl shadow-brutal text-center transform -rotate-1 max-w-sm mx-4\"><div class=\"text-4xl mb-4\">ğŸ¶</div><h3 class=\"text-xl font-bold mb-2\">Request YTM Terkirim!</h3><p class=\"text-gray-600\">Lagu akan diputar atau masuk antrian setelah disetujui Host.</p></div></div><!-- Party Mode Overlay (Full Screen, Click-through) --> <!-- Only visible when Nobar Modal is OPEN and NOT MINIMIZED --> <div x-show=\"showNobarModal && !nobarMinimized && !nobarIsFullscreen\" x-transition:enter=\"transition ease-out duration-1000\" x-transition:leave=\"transition ease-in duration-500\" class=\"fixed inset-0 z-40 pointer-events-none\" :class=\"{\n\t\t\t'party-chill': partyMode === 'chill',\n\t\t\t'party-rave-slow': partyMode === 'rave-slow',\n\t\t\t'party-rave-medium': partyMode === 'rave-medium',\n\t\t\t'party-rave-fast': partyMode === 'rave-fast',\n\t\t\t'party-rave-insane': partyMode === 'rave-insane',\n\t\t\t'party-galau': partyMode === 'galau',\n\t\t\t'party-disco': partyMode === 'disco',\n\t\t\t'party-horror': partyMode === 'horror',\n\t\t\t'party-zen': partyMode === 'zen',\n\t\t\t'party-cinema': partyMode === 'cinema'\n\t\t}\"></div><!-- Floating Music/Nobar Widget (Mobile) --> <div class=\"fixed bottom-20 right-4 z-40 flex flex-col gap-2 items-end lg:hidden pointer-events-none\"><!-- No Party Controls for Mobile (Desktop Only) --></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = layouts.Base(getTitle(roomName), users).Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
